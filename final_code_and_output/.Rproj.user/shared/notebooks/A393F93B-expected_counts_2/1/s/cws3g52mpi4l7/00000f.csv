"0","library(dplyr)"
"2","
Attaching package: ‘dplyr’

"
"2","The following objects are masked from ‘package:stats’:

    filter, lag

"
"2","The following objects are masked from ‘package:base’:

    intersect, setdiff, setequal, union

"
"0","source('../main_sim/fns_sim.R')"
"0",""
"0","pL_geom_1M <- function(l, psi, phi, M) {"
"0","  if (l == 1) {return(phi*psi/(phi*psi + psi^2*(1 - phi - (1 - phi)^M)))}"
"0","  else {return(phi*(1-phi)^(l-1)*psi^2/(phi*psi + psi^2*(1 - phi - (1 - phi)^M)))}"
"0","}"
"0",""
"0","get_exp_freq_1M <- function(psi, phi, M) {"
"0","  density <- lapply(1:1500, pL_geom_1M, psi, phi, M) %>% unlist()"
"0","  return(density)"
"0","}"
"0",""
"0","get_exp_freq_2M <- function(psi, phi, M) {"
"0","  density <- lapply(2:1500, pL_geom_2M, psi, phi, M) %>% unlist()"
"0","  return(density)"
"0","}"
"0",""
"0","sim.0.5 <- readRDS(""../main_sim/res.sim.2M.1500.region.5000.ibdclust2cM.MAF.0.5.boot.keep.ends.rds"")"
"0","tracts <- lapply(sim.0.5, function(x) {return(x[[3]])}) %>% unlist() %>% matrix(byrow = TRUE, ncol = 2)"
"0","psi <- lapply(sim.0.5, function(x){return(x[[4]])}) %>% unlist() "
"0",""
"0","sim.tracts <- readRDS(""../sim_tracts/res.geom.rds"")"
"0","sim.tracts.l <- lapply(sim.tracts, function(x) {return(x[[4]])}) %>% unlist()"
"0","sim.tracts.psi <- lapply(sim.tracts, function(x){return(x[[5]])}) %>% unlist() "
